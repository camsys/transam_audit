:ruby
  table_dom_id = SecureRandom.hex



#table_actions.btn-toolbar
  = render :partial => "index_actions"




:css

  .col-item:nth-child(1){
    width:10%;
  }
  .col-item:nth-child(2){
    width:12%;
  }
  .col-item:nth-child(3){
    width:12%;
  }
  .col-item:nth-child(4){
    width:12%;
  }
  .col-item:nth-child(5){
    width:8%;
  }
  .col-item:nth-child(6){
    width:8%;
  }
  .col-item:nth-child(7){
    width:8%;
  }
  .col-item:nth-child(8){
    width:12%;
  }

= javascript_include_tag  "https://kit.fontawesome.com/#{ENV['FONT_AWESOME']}.js"
.library-table
  %table.elbat{:id => table_dom_id,
    :use => 'true',
    :data => {:use => 'true',
      :side => 'client',
      :current_page => '0',
      :current_page_size => '10',
      :page_sizes => "10,20,50,100,200",
      :search => 'client',
      :export => "['csv', 'txt', 'excel']",
      :columns => "Organization,drilldown-link,
                  Audit Type,
                  Type,
                  Asset ID,
                  Description,
                  Result,
                  Updated At,right-align,
                  Notes,",
        :selected_columns => "Organization,
                  Audit Type,
                  Type,
                  Asset ID,
                  Description,
                  Result,
                  Updated At,
                  Notes",
      :cookies => "true",
      :sort => 'client',
      :params => "{}",
      :filter => "[]",
      :data_source => 'client',
      :url => ''}}

  - audit_results.each_with_index do |a, index|
    - unless a.auditable.nil?
      :javascript
        add_row('#{table_dom_id}',
        {        
          "Organization": '#{h link_to a.organization.short_name }',
          "Audit Type": '#{h a.audit }',
          "Type": '#{h a.class_name }',
          "Asset ID": '#{h a.auditable.asset_tag }',
          "Description": '#{h a.auditable.description }',
          "Result": '#{h a.audit_result_type }',
          "Updated At": '#{h format_as_date(a.updated_at) }',
          "Notes": '#{h sanitize(a.notes, tags:[]).gsub("\n", ' ') }',
        }, #{index});





-# .table-responsive
-#   %table.table.table-hover{:id => 'audit_results_table', :data => {:toggle => 'table',
-#     :pagination => 'true',
-#     :show_pagination_switch => 'false',
-#     :page_list => "[5, 10, 20, 50, 100, 200, 10000]",
-#     :page_size => current_user.num_table_rows,
-#     :search => 'false',
-#     :toolbar => "#table_actions",
-#     :export_types => "['csv', 'txt', 'excel']",
-#     :show_export => 'false',
-#     :resizable => 'true',
-#     :show_columns => 'false',
-#     :show_toggle => 'false',
-#     :maintain_selected => 'true',
-#     :single_select => 'false',
-#     :cookie => 'true',
-#     :cookie_id_table => "audit_results_assets_id",
-#     :cookie_expire => "1y"}}
-#     %thead
-#       %tr
-#         %th.center{:data => {:field => 'checked', :checkbox => 'true'}}
-#         %th.center{:data => {:field => 'object_key', :visible => 'false'}}
-#         - if @organization_list.count > 1
-#           %th.center{:data => {:field => 'org', :sortable => 'true'}} Org
-#         %th.center{:data => {:sortable => 'true'}} Audit
-#         %th.center{:data => {:field => 'object_type', :sortable => 'true'}} Type
-#         %th.center{:data => {:sortable => 'true'}} Asset Tag
-#         %th.center{:data => {:sortable => 'true'}} Description
-#         %th.center{:data => {:sortable => 'true'}} Result
-#         %th.center{:data => {:sortable => 'true'}} Updated At
-#         %th.center{:data => {:sortable => 'true'}} Notes

-#     %tbody
-#       - audit_results.each do |a|
-#         -unless a.auditable.nil? #Don't show results for objects that have been deleted
-#           %tr
-#             %td
-#             %td.center.nowrap= a.auditable.object_key
-#             - if @organization_list.count > 1
-#               %td.left.nowrap= a.organization.short_name
-#             %td.center.nowrap= a.audit
-#             %td.left.nowrap= a.class_name
-#             %td.left.nowrap
-#               %span.hidden= a.auditable.asset_tag
-#               = link_to a.auditable.asset_tag, inventory_path(a.auditable)
-#             %td.left.nowrap= a.auditable.description
-#             %td.center.nowrap= a.audit_result_type
-#             %td.center.nowrap= format_as_date(a.updated_at)
-#             %td.left= format_as_text(a.notes)

= render :partial => 'shared/table_scripts', :locals => {:table_id => 'audit_results_table', :path_pattern => activity_path("xxx")}
